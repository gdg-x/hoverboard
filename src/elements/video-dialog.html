<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/google-youtube/google-youtube.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-dialog-behavior/paper-dialog-behavior.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">

<dom-module id="video-dialog">
    <template>

        <style>
             :host {
                position: absolute;
                top: 0;
                right: 0;
                bottom: 0;
                left: 0;
                margin: 0;
                padding: 0;
                position: fixed;
            }

            .video-wrapper {
                z-index: 6;
                overflow: hidden;
            }

            .toolbar {
                top: 0;                
                z-index: 7;
                width: 100%;
                height: 50px;
                background: rgba(0, 0, 0, .5);
                position: absolute;
            }

            .go-back-icon {
                z-index: 9;
                width: 40px;
                height: 40px;
                color: #fff;
                opacity: 0.8;
                background-color: var(--default-primary-color);
                border-radius: 50%;
                display: block;               
                margin-top: 5px;
            }

            .video {
                position: absolute;
                top: 0;
                right: 0;
                bottom: 0;
                left: 0;
                padding: 0;
            }

            @media (min-width: 868px) {
                .toolbar:hover .go-back-icon {
                    display: block;
                }

                .go-back-icon {
                    display: none;
                }
            }
        </style>

        <div class="toolbar">
            <paper-icon-button dialog-dismiss class="go-back-icon" icon="hoverboard:arrow-back" on-tap="_closeVideo"></paper-icon-button>
        </div>
        <div class="video-wrapper">
            <google-youtube 
                id="video"
                class="video"
                video-id="[[youtubeId]]"
                width="100%"
                height="100%"
                autohide="1"
                chromeless="[[disableControls]]">
            </google-youtube>
        </div>

    </template>

    <script>
        class VideoDialog extends Polymer.mixinBehaviors([Polymer.PaperDialogBehavior], Polymer.Element) {

            static get is() {
                return 'video-dialog'
            }

            static get properties() {
                return {
                    videoTitle: {
                        type: String
                    },
                    opened: {
                        type: Boolean
                    },
                    youtubeId: {
                        type: String
                    },
                    disableControls: {
                        type: Boolean,
                        value: false
                    }
                }
            }

            static get observers() {
                return [
                    'videoDialogActionMade(opened)'
                ];
            }

            videoDialogActionMade(opened) {
                if (opened) {
                    this._openVideo();
                }
                else {
                    this._closeVideo();
                }
            }

            _openVideo() {
                if (this.withBackdrop) {
                    this.backdropElement.open();
                }
                this.$.video.play();
            }

            _closeVideo() {                
                this.$.video.seekTo(0);
                this.$.video.pause();
                this.backdropElement.close();
                this.opened = false;                
            }
        }


        customElements.define(VideoDialog.is, VideoDialog);
    </script>
</dom-module>